"use strict";var _createClass=function(){function a(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,s){return e&&a(t.prototype,e),s&&a(t,s),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(function(){var n={}.hasOwnProperty;jQuery(function(a){return window.Membership_Settings_Seat_Change_Form=function(){function s(t){var e=this;_classCallCheck(this,s),this.validate_seat_input=this.validate_seat_input.bind(this),this.unset_error=this.unset_error.bind(this),this.set_error=this.set_error.bind(this),this.settings=window.wc_memberships_teams_area_team_settings,this.form=a(t),this.submit=a("#submit-seats-form"),this.message=a("#seat-change-message"),this.instructions=a("#team-seat-form-instructions"),this.input=a("#team-seats-field"),this.input.on("change click keyup",this.validate_seat_input).change(),a(".my_team_details a.update_seats").on("click",function(){return e.toggle_display(),!1})}return _createClass(s,[{key:"toggle_display",value:function(){return this.form.slideToggle(250)}},{key:"validate_seat_input",value:function(){var t,e,s;for(e in s={no_change:(t=this.get_new_seat_count())===this.settings.team.current_seats,add_only:"update_seats"!==this.settings.team.seat_change_mode&&t<this.settings.team.current_seats,empty:NaN===t||t<=0||""===t||"0"===this.input.val()||""===this.input.val(),above_max:"add_seat_blocks"!==this.settings.team.seat_change_mode&&0<this.settings.team.max_seats&&t>this.settings.team.max_seats,below_min:0<this.settings.team.min_seats&&t<this.settings.team.min_seats,not_enough_free_seats:t<this.settings.team.current_seats&&t<this.settings.team.used_seats},this.unset_error(),s)if(n.call(s,e)&&s[e])return this.set_error(this.settings.validation_errors[e],e)}},{key:"unset_error",value:function(){return this.submit.prop("disabled",!1),this.form.removeClass("validation-error"),this.message.html(this.get_seat_change_message())}},{key:"set_error",value:function(t,e){return this.submit.prop("disabled",!0),"no_change"!==e&&this.form.addClass("validation-error"),this.message.html(t)}},{key:"get_seat_change_message",value:function(){var t,e,s,a,n,i;return e=this.get_seat_change_count(),n=this.get_new_seat_count(),0===e?"":(t=0<e?"add":"remove",s=1===(e=Math.abs(e))?"singular":"plural",i=1===n?"singular":"plural",a={count:e,total_count:n,action:this.settings.seat_change_message.actions[t],seat_n:this.settings.seat_change_message.seat_n[s],total_seat_n:this.settings.seat_change_message.seat_n[i]},e&&n?this.build_seat_change_message(a):void 0)}},{key:"get_new_seat_count",value:function(){var t;switch(t=parseInt(this.input.val()),this.settings.team.seat_change_mode){case"update_seats":return t;case"add_seats":return this.settings.team.current_seats+t;case"add_seat_blocks":return this.settings.team.current_seats+t*this.settings.team.max_seats}return 0}},{key:"get_seat_change_count",value:function(){return this.get_new_seat_count()-this.settings.team.current_seats}},{key:"build_seat_change_message",value:function(t){var e,s,a;for(e in s=this.settings.seat_change_message.template,t)n.call(t,e)&&(a=t[e],s=s.replace("{"+e+"}",a));return s}}]),s}(),new Membership_Settings_Seat_Change_Form("#team-seat-update-form")})}).call(void 0);